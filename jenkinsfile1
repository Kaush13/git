pipeline {
	  agent any
	  stages {
		  stage('One') {
   		  steps {
                         echo 'Hi,This is Kaushik'
			}
		  }
		  stage('Two') {
		  steps {
			 input('Do you want to proceed?')
			}
		  }
		  stage('Three') {
		  when {
          		not {
			      branch "master"
			    }
		       }
		  steps {
			  echo "Hello"
			}
		  }
		  stage('Four') {
		  parallel {
		  stage('Unit Test') {
		  steps {
			  echo "Running the unit test"
			}
		}
		  stage('Integration Test') {
		  agent {
			 docker {
				 reuseNode false
				 image 'jenkins'
				 docker.build("kaushdoc/jd")
				}
			}
		  steps {
			 echo "Running the integration Test"
			}
		}
		  stage('Pushing the image') {
		  docker.withRegistry('https://registry.hub.docker.com') {
		  docker.push("$(env.BUILD_NUMBER)")
                  docker.push("latest")
		}
		  echo "Trying to push the image to dockerhub"		 
}
}
}
}
	 
